
## 单条件排名

## 多条件排名
### 1 使用 SUMPRODUCT 实现多条件排名
假设有以下数据：

|A	|B	|C|
|---|---|---|
|姓名|	部门|	销售额|
|张三|	销售部|	5000|
|李四|	技术部|	3000|
|王五|	销售部|	8000|
|赵六|	销售部|	5000|

根据 部门 和 销售额 对员工进行排名。
在 D 列中输入以下公式：
`=SUMPRODUCT((B$2:B$5=B2) * (C$2:C$5>C2)) + 1`
结果：  

|A	|B	C|	|D|
|---|---|---|---|
|张三|	销售部|	5000|	2|
|李四|	技术部|	3000|	1|
|王五|	销售部|	8000|	1|
|赵六|	销售部|	5000|	2|

- 解释：
  - (B$2:B$5=B2)：筛选出与当前行部门相同的行。
  - (C$2:C$5>C2)：筛选出销售额大于当前行的行。
  - SUMPRODUCT 计算满足条件的行数，再加 1 得到排名。

### 2 使用 COUNTIFS 实现多条件排名
在 D 列中输入以下公式：  
`=COUNTIFS(B$2:B$5, B2, C$2:C$5, ">" & C2) + 1`
结果：

|A	|B|	C	|D|
|---|---|---|---|
|张三 |销售部|	5000|	2|
|李四|	技术部|	3000|	1|
|王五|	销售部|	8000|	1|
|赵六|	销售部|	5000|	2|

- 解释
  - `COUNTIFS(B$2:B$5, B2, C$2:C$5, ">" & C2)`：统计部门相同且销售额大于当前行的行数。
### 3 处理并列排名
如果需要处理并列排名（即相同值具有相同排名），可以使用以下方法。
`=SUMPRODUCT((B$2:B$5=B2) * (C$2:C$5>C2)) + 1`
结果：

|A	|B	|C	|D|
|---|---|---|---|
|张三|  销售部|	5000|	2|
|李四|	技术部|	3000|	1|
|王五|	销售部|	8000|	1|
|赵六|	销售部|	5000|	2|

- 解释：
 - 如果有相同的销售额，它们的排名会相同。


### 4 多条件加权排名
假设有以下数据：

|A	|    B|	   |C|	   D|
|---|---|---|---|---|
|姓名|	部门	|销售额| 利润|
|张三|	销售部	|5000|	|1000|
|李四|	技术部	|3000|	|800|
|王五|	销售部	|8000|	|2000|
|赵六|	销售部	|5000|	|1500|

根据 销售额 和 利润 对员工进行加权排名（销售额权重 70%，利润权重 30%）。
1. 计算加权得分：=C2*0.7 + D2*0.3
2. 在 E 列中输入以下公式进行排名：
`=SUMPRODUCT((B$2:B$5=B2) * ((C$2:C$5*0.7 + D$2:D$5*0.3) > (C2*0.7 + D2*0.3))) + 1`

结果：

|A	|    B	   | C	    |D	  |  E|
|---|---|---|---|---|
|张三|	销售部|	5000|	1000|	2|
|李四|	技术部|	3000|	800	|    1|
|王五|	销售部|	8000|	2000|	1|
|赵六|	销售部|	5000|	1500|	2|

